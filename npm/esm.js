const sto=setTimeout,isFunc=e=>"function"==typeof e;function filteredArray(e,t){const r=Object.assign([],e);let n=0;for(var o=t.length;n<o;){var c=r.indexOf(t[n]);0<=c&&r.splice(c,1),n++}return r}function escHTML(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function styleToString(r){return Object.keys(r).reduce((e,t)=>e+t.split(/(?=[A-Z])/).join("-").toLowerCase()+":"+r[t]+";","")}function removeAttributes(e,c){return("string"==typeof e?e:e()).replace(/ c-.*="\d+"/g,e=>{var t=(e||"").split(" ");let r="";for(let e=0;e<t.length;e++){var n,o=c[t[e]];o&&({key:o,value:n}=o,"object"==typeof n&&"ref"!==o&&(r+=` ${o}="${styleToString(n)}"`),!0===n&&(r+=" "+o))}return r})}function hasChange(r,e){return!r||r.length!==e.length||e.some((e,t)=>e!==r[t])}function runCleanup(e){isFunc(e.clean)&&e.clean()}function invoveEffect(e,t){"boolean"!=typeof t&&(runCleanup(e),e.clean=void 0),isFunc(e.val)&&sto(()=>e.clean=e.val())}function cleanEffect(e){e.hook&&sto(()=>e.hook.s.forEach(runCleanup))}function runEffectFromStates(e,t){if(e.length){const r=e.filter(e=>!0===e.status),n=e.filter(e=>!1===e.status);r.length&&sto(()=>r.forEach(e=>invoveEffect(e,t))),n.length&&n.forEach(e=>invoveEffect(e,t))}}const isVanicAttr=e=>"c"===e[0]&&"-"===e[1];function isNotMatch(e,t){return e.nodeType!==t.nodeType||e.tagName!==t.tagName||e.id!==t.id||e.src!==t.src||getAttr(e,"c-comp")!==getAttr(t,"c-comp")}function getAttr(e,t){return e.getAttribute?e.getAttribute(t):""}function getNodeContent(e,t){return t?"href"===t||isVanicAttr(t)||"string"!=typeof e[t]?getAttr(e,t):e[t]:e.childNodes&&0<e.childNodes.length?null:e.textContent}function diff(e,i){const l=Array.prototype.slice.call(i.childNodes),t=Array.prototype.slice.call(e.childNodes);let r=l.length-t.length;if(0<r)for(;0<r;r--)l[l.length-r].parentNode.removeChild(l[l.length-r]);t.forEach(function(t,r){if(!l[r])return e=t.cloneNode(!0),void i.appendChild(e);if(t.attributes&&t.attributes.length){let e=0;for(var n=t.attributes.length;e<n;){var o=t.attributes[e];if(o.name){var c=getNodeContent(t,o.name)||"";if(c!==(getNodeContent(l[r],o.name)||"")){let e=o.name;isVanicAttr(e)?"c-comp"!==e&&l[r].setAttribute&&l[r].setAttribute(e,c):("class"===e?e="className":"for"===e&&(e="htmlFor"),l[r][e]=c)}}e++}}if(isNotMatch(t,l[r]))l[r].parentNode.replaceChild(t.cloneNode(!0),l[r]);else{var e=getNodeContent(t);if(e&&e!==getNodeContent(l[r])&&(l[r].textContent=e),!(0<l[r].childNodes.length&&t.childNodes.length<1))return l[r].childNodes.length<1&&0<t.childNodes.length?(diff(t,e=document.createDocumentFragment()),void l[r].appendChild(e)):void(0<t.childNodes.length&&diff(t,l[r]));l[r].innerHTML=""}})}let reRender,reElem,fno=[],rep={},idx=0,hid=0,curComp,primIndex=0,lastRes;const primObject={},dangerHTML="dangerouslySetInnerHTML";function _render(e){var t=e();const r=document.createElement("div");r.innerHTML=t,diff(r,reElem);let n=fno.length;for(;n--;){const a=fno[n];var o=a.value,c=a.key.toLowerCase();if("ref"!==c){const s=reElem.querySelector(`[c-${c}="${n}"]`);if(s)if("object"==typeof o)for(const u in o)s[c][u]=o[u];else s[c]=o}}idx=0,fno=[];var i,l=reElem.querySelectorAll("[c-comp]");reRender&&l.length!==primIndex&&(l=Array.prototype.map.call(l,e=>e.getAttribute&&e.getAttribute("c-comp")),filteredArray(i=lastRes.match(/(?<=c-comp=")(.*?)(?=")/gm)||[],l).forEach(e=>{e=primObject[e];e&&cleanEffect(e)}),filteredArray(l,i).forEach(e=>{e=primObject[e];if(e){const t=e["hook"];t.y.splice(0),t.e.splice(0),runEffectFromStates(t.s,!0)}}),primIndex=l.length),lastRes=t,reRender=e}function html(e){const s=[].slice.call(arguments,1);return e.reduce((e,t,r)=>{let n=s[r-1];null!==n&&void 0!==n||(n="");r=typeof(n=Array.isArray(n)?n.join(""):n);if("function"==r||"boolean"==r||"object"==r){const l=e.match(/[^ ]+/g);var o=n,c=(l[l.length-1]||"").replace(/=|"/g,"").toLowerCase();if(!/<|>/.test(c)){var i=idx++;const a=`c-${c}="`+i;"ref"===c&&(n.ref=()=>document.querySelector(`[${a}"]`)),fno[i]={key:c,value:o},"function"!=r&&(rep[a+'"']={key:c,value:o}),e=l.slice(0,-1).join(" ")+(" "+a)}n=""}return e+String(n)+t})}function renderToString(e){return removeAttributes(e,rep)}function render(e,t){reRender=void 0,lastRes=void 0,fno=[],rep={},idx=0,reElem=t,_render(e)}const comp=n=>{const o=i.hook={i:0,e:[],y:[],s:[]},c=hid++;function i(e){var t=curComp;curComp=i,o.i=0;let r=n(void 0===e?{}:e);return"string"==typeof r&&(r=(r=/<.*>/.test(r)?r:`<notag>${r}</notag>`).replace(/>/,` c-comp="${c}">`),primObject[""+c]=curComp,reRender||primIndex++),t&&(curComp=t),reRender?(o.e.length&&sto(()=>o.e.splice(0).forEach(invoveEffect)),o.y.length&&o.y.splice(0).forEach(invoveEffect)):runEffectFromStates(o.s),r}return i},buildEffect=l=>(e,t)=>{if(reElem){const{i:n,s:o,e:c,y:i}=curComp.hook;t=t||o.map(e=>e.state).filter(Boolean);var r=n>=o.length;r&&(o[n]={deps:t,val:e,status:l}),reRender&&(r||hasChange(o[n].deps,t))&&(l?c:i).push(o[n]),o[n].val=e,o[n].deps=t,o[n].status=l,curComp.hook.i++}};function useState(e){const{s:t,i:r}=curComp.hook,n=void 0===t[r]?e:t[r].state;return r>=t.length&&t.push({state:n}),curComp.hook.i++,[n,e=>{t[r].state=isFunc(e)?e(n):e,_render(reRender)},()=>t[r].state]}const useEffect=buildEffect(!0),useLayoutEffect=buildEffect(!1);function useReducer(t,e,r){const n=useState(void 0!==r?r(e):e);return[n[0],e=>{n[1](t(n[0],e))}]}function useMemo(e,t){if(!reElem)return e();const{i:r,s:n}=curComp.hook;return t=t||n.map(e=>e.state).filter(Boolean),(r>=n.length||hasChange(n[r].deps,t))&&(n[r]={val:e(),deps:t}),curComp.hook.i++,n[r].val}const useCallback=(e,t)=>useMemo(()=>e,t),useRef=e=>useMemo(()=>({current:e,ref:()=>e}),[]),createContext=r=>{let n;return{Provider(e,t){return n=e||r,t()},v:()=>n}},useContext=e=>e.v();function h(e,t){var r=[].slice.call(arguments,2);const n=[];let o="";t=t||{};for(let e=r.length;e--;)n.push("number"==typeof r[e]?String(r[e]):r[e]);if(isFunc(e))return t.children=n.reverse(),e(t);if(e){if(o+="<"+e,t)for(var c in t)if("children"!==c){let e=t[c];var i=typeof e;if("function"==i||"boolean"==i||"object"==i){var l=e,a=c.toLowerCase();const u=idx++;"ref"===a&&(e.ref=()=>document.querySelector(`[c-${u}="${u}"]`)),fno[u]={key:a,value:l},c="c-"+a,e=u,"function"!=i&&(rep[`${c}="${e}"`]={key:a,value:l})}void 0!==e&&!1!==e&&null!==e&&c!==dangerHTML&&(o+=` ${c}="${escHTML(e)}"`)}o+=">"}if(-1===["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"].indexOf(e)){if(t[dangerHTML])o+=t[dangerHTML].__html;else for(let e=n.length;e--;){var s=Array.isArray(n[e])?n[e].join(""):n[e];"string"==typeof s&&(o+="<"!==s[0]?escHTML(s):s)}o+=e?`</${e}>`:""}return o}const Fragment=({children:e})=>h(null,null,e);export{Fragment,comp,createContext,h,html,render,renderToString,useCallback,useContext,useEffect,useLayoutEffect,useMemo,useReducer,useRef,useState};
